GripLock does not custody keys, shares, or recovery data.

In V2, recovery is handled through **Shamir 2-of-3 secret sharing** — the MASTER_SECRET is split into three shares, distributed across independent storage locations. Any two shares are sufficient to reconstruct the wallet. No single share reveals anything about the secret.

This page describes the share distribution model, recovery scenarios, factor rotation, and the boundaries of what GripLock can and cannot recover.

---

## No Custodial Recovery

GripLock does not hold any share of the user's MASTER_SECRET.

This means:
- GripLock cannot restore wallets on behalf of users
- GripLock cannot reset access independently
- GripLock cannot bypass authentication or intent requirements
- There is no admin override, support backdoor, or escrow mechanism

Recovery is entirely user-controlled. GripLock provides the tools — the user holds the shares.

---

## Share Distribution

The MASTER_SECRET is split into three Shamir shares at wallet provisioning time:

| Share | Encrypted With | Stored At | Survives |
|-------|---------------|-----------|----------|
| **Share A** | K_user (Argon2id from PIN/Secret) | Google Drive (DriveRecoveryObject) | Phone loss ✅ |
| **Share B** | K_dev (Secure Enclave / Keystore) | Device local storage (DeviceRecoveryObject) | PIN forgotten ✅ |
| **Share C** | Passkey-derived key | Passkey provider (PasskeyWrappedShare) | Phone loss ✅, PIN forgotten ✅ |

Any **2 of 3** shares are sufficient to reconstruct the MASTER_SECRET via Shamir interpolation. No single share, and no combination of encryption keys without the corresponding share, reveals any information about the secret.

---

## Recovery Scenarios

### Phone Lost or Destroyed

The user has lost access to their device. Share B (device-local) is unavailable.

**Recovery path**: Share A (Google Drive) + Share C (Passkey)

1. User signs in to Google Drive on a new device → retrieves DriveRecoveryObject
2. User completes Passkey ceremony → decrypts Share C
3. User enters PIN/Secret → derives K_user → decrypts Share A
4. Shamir interpolation reconstructs MASTER_SECRET from Share A + Share C
5. New K_dev is generated on the new device's Secure Enclave
6. Share B is re-encrypted with new K_dev and stored locally

The wallet is fully restored. The old device's Share B is cryptographically useless without the old K_dev.

---

### PIN or Secret Forgotten

The user cannot derive K_user. Share A (encrypted with K_user) is effectively inaccessible.

**Recovery path**: Share B (Device) + Share C (Passkey)

1. User authenticates with device biometrics → K_dev decrypts Share B
2. User completes Passkey ceremony → decrypts Share C
3. Shamir interpolation reconstructs MASTER_SECRET from Share B + Share C
4. User sets a new PIN/Secret → new K_user is derived via Argon2id
5. Share A is re-encrypted with new K_user → uploaded to Google Drive

Access is restored with new credentials. The old DriveRecoveryObject is replaced.

---

### Passkey Lost

The user's Passkey provider is unavailable. Share C is inaccessible.

**Recovery path**: Share A (Google Drive) + Share B (Device)

1. User enters PIN/Secret → derives K_user → decrypts Share A
2. Device biometrics → K_dev decrypts Share B
3. Shamir interpolation reconstructs MASTER_SECRET from Share A + Share B
4. User registers a new Passkey → derives new encryption key → re-encrypts Share C

Access is restored. The new PasskeyWrappedShare replaces the old one.

---

## Recovery Matrix

| Scenario | Available Shares | Recovery Possible |
|----------|-----------------|-------------------|
| Phone lost | A + C | ✅ Yes |
| PIN/Secret forgotten | B + C | ✅ Yes |
| Passkey lost | A + B | ✅ Yes |
| Phone lost + PIN forgotten | C only | ❌ No |
| Phone lost + Passkey lost | A only | ❌ No |
| PIN forgotten + Passkey lost | B only | ❌ No |
| All three lost | None | ❌ No |

If only one share remains accessible, reconstruction is impossible. This is by design — the 2-of-3 threshold ensures that no single compromised factor can expose the wallet.

---

## Factor Rotation

GripLock V2 supports rotating any factor without migrating the wallet:

- **Change PIN/Secret**: Reconstruct MASTER_SECRET → derive new K_user → re-encrypt Share A → upload to Drive
- **Replace device**: Reconstruct MASTER_SECRET → generate new K_dev on new hardware → re-encrypt Share B
- **Replace Passkey**: Reconstruct MASTER_SECRET → register new Passkey → re-encrypt Share C
- **Replace NFC card**: Update uidHash in recovery metadata — no share re-encryption required

Rotation requires access to at least 2 of 3 shares. It does not require GripLock involvement.

---

## Funds Are Always On-Chain

Regardless of recovery status:
- Funds remain on-chain and unaffected by device or credential loss
- The blockchain state is independent of GripLock's session model
- Loss of all shares does not destroy funds — it makes them inaccessible through GripLock

GripLock controls access to signing capability. It does not control the assets themselves.

---

## User Responsibility Model

GripLock provides the recovery architecture. The user holds the factors.

Users are responsible for:
- Maintaining access to at least 2 of 3 share locations
- Safeguarding their PIN/Secret
- Keeping their Passkey provider accessible
- Understanding that GripLock cannot intervene in recovery

GripLock provides control, not custody. Security is preserved by refusing to offer shortcuts.

---

> **Summary**
> GripLock V2 splits the MASTER_SECRET into 3 Shamir shares across Google Drive, the device, and a Passkey provider.
> Any 2 of 3 shares reconstruct the wallet. Any single share reveals nothing.
> GripLock cannot recover what it never holds. Recovery is user-controlled, threshold-based, and non-custodial.

---

<Info>
This page describes **GripLock V2** architecture. See the [Changelog](/changelog) for version history and V1 comparison.
</Info>
